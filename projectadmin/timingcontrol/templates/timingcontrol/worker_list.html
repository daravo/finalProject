{% extends 'base_generic.html' %} {% block content %} {% block title %}
<title>Employees</title> {% endblock title %}
<h1>Workers list</h1>

{% if worker_list %}
<div id="app" class="container">
  <div class="col-lg-6 form-group">
    <label>Nombre</label>
    <input type="text" class="form-control" v-model="name" />
  </div>
  <div class="col-lg-6 form-group">
    <label>Apellidos</label>
    <input type="text" class="form-control" v-model="last_name" />
  </div>
  <div class="col-lg-6 form-group">
    <label>Job</label>
    <input type="text" class="form-control" v-model="job" />
  </div>
  <div class="col-lg-6 form-group">
    <label>Buscar</label>
    <input
      placeholder="Buscar..."
      type="text"
      class="form-control"
      v-model="kword"
    />
  </div>
<p>[[kword]]</p>
  <table class="table table-primary table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">Profile</th>
        <th scope="col">Last name</th>
        <th scope="col">First name</th>
        <th scope="col">Job position</th>
        <th scope="col">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for worker in worker_list %}
      <tr class="align-middle">
        <td>
          <a class="btn btn-success" href="{{ worker.get_absolute_url }}"
            >Go to profile</a
          >
        </td>
        <td>{{ worker.surname }}</td>
        <td>{{ worker.name }}</td>
        <td>{{ worker.job }}</td>
        <td>
          <span>
            <a
              class="btn btn-outline-danger"
              href="{% url 'worker_delete' worker.id %}"
              >Delete user</a
            >
            <a
              class="btn btn-outline-info"
              href="{% url 'worker_update' worker.id %}"
              >Update user</a
            ></span
          >
        </td>
      </tr>

      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<p>There are no workers registered</p>
{% endif %}
<!--
{% block vue %} {% load static %}
<script src="{% static 'js/worker_search.js' %}"></script>
{% endblock vue %} 
-->
<script>
    new Vue({
        el: "#app",
        delimiters: ["[[", "]]"],
        data: {
          name: '',
          last_name: '',
          job: '',
          kword: 'key word',
          lista_seleccionados: [],
          lista_workers: [],
        },
        watch: {
          kword: function (val) {
            this.buscar_workers(val);
          },
        },
        methods: {
          buscar_workers: function (kword) {
            let self = this;
            axios
              .get("/api/workers/?kword=" + kword)
              .then(function (response) {
                self.lista_workers = response.data;
                console.log(self.lista_Workers);
              })
              .catch(function (error) {
                console.log(error);
              });
          },
        },
      });
      
</script>

{% endblock content %}
